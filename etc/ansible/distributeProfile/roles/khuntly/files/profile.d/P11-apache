#==============================================================================
#
#          FILE:  functions
#         USAGE:  . functions
#   DESCRIPTION:  Sets application-wide functions
#
#       OPTIONS:  ---
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR:  Kevin Huntly <kmhuntly@gmail.com>
#       COMPANY:  ---
#       VERSION:  1.0
#       CREATED:  ---
#      REVISION:  ---
#
#==============================================================================

[ ! -z "${ENABLE_VERBOSE}" ] && [ "${ENABLE_VERBOSE}" = "${_TRUE}" ] && set -x || set +x;
[ ! -z "${ENABLE_TRACE}" ] && [ "${ENABLE_TRACE}" = "${_TRUE}" ] && set -v || set +v;

trap '[ ! -z "${ENABLE_VERBOSE}" ] && [ "${ENABLE_VERBOSE}" = "${_TRUE}" ] || set +x; [ ! -z "${ENABLE_TRACE}" ] && [ "${ENABLE_TRACE}" = "${_TRUE}" ] set +v; set -o noclobber' INT TERM EXIT;

## activemq
[ -d "/opt/Apache/activemq/current" ] && typeset -x ACTIVEMQ_HOME="/opt/Apache/activemq/current";
[ ! -z "${ACTIVEMQ_HOME}" ] && typeset -x PATH="${PATH}:${ACTIVEMQ_HOME}/bin";
[ ! -z "${ACTIVEMQ_HOME}" ] && typeset -x LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:${ACTIVEMQ_HOME}/lib";
[ ! -z "${ACTIVEMQ_HOME}" ] && typeset -x LIBPATH="${LIBPATH}:${ACTIVEMQ_HOME}/lib";
[ ! -z "${ACTIVEMQ_HOME}" ] && typeset -x LIB_PATH="${LIB_PATH}:${ACTIVEMQ_HOME}/lib";

## apacheds
[ -d "/opt/Apache/apacheds/current" ] && typeset -x APACHEDS_HOME="/opt/Apache/apacheds/current";
[ ! -z "${APACHEDS_HOME}" ] && typeset -x PATH="${PATH}:${APACHEDS_HOME}/bin";
[ ! -z "${APACHEDS_HOME}" ] && typeset -x LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:${APACHEDS_HOME}/lib";
[ ! -z "${APACHEDS_HOME}" ] && typeset -x LIBPATH="${LIBPATH}:${APACHEDS_HOME}/lib";
[ ! -z "${APACHEDS_HOME}" ] && typeset -x LIB_PATH="${LIB_PATH}:${APACHEDS_HOME}/lib";

## apache ant
[ -d "/opt/Apache/ant/current" ] && typeset -x ANT_HOME="/opt/Apache/ant/current";
[ ! -z "${ANT_HOME}" ] && typeset -x ANT_OPTS="${JAVA_OPTS}";
[ ! -z "${ANT_HOME}" ] && typeset -x PATH="${PATH}:${ANT_HOME}/bin";
[ ! -z "${ANT_HOME}" ] && typeset -x LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:${ANT_HOME}/lib";
[ ! -z "${ANT_HOME}" ] && typeset -x LIBPATH="${LIBPATH}:${ANT_HOME}/lib";
[ ! -z "${ANT_HOME}" ] && typeset -x LIB_PATH="${LIB_PATH}:${ANT_HOME}/lib";

## apache maven
[ -d "/opt/Apache/maven/current" ] && typeset -x MAVEN_HOME="/opt/Apache/maven/current";
[ ! -z "${MAVEN_HOME}" ] && typeset -x MAVEN_OPTS="${JAVA_OPTS} -DskipTests -Dmaven.test.skip=true";
[ ! -z "${MAVEN_HOME}" ] && typeset -x M2_HOME="/opt/Apache/maven/current";
[ ! -z "${MAVEN_HOME}" ] && typeset -x M2_OPTS="${JAVA_OPTS} -DskipTests -Dmaven.test.skip=true";
[ ! -z "${MAVEN_HOME}" ] && typeset -x MAVEN_REPOSITORY="/cygdrive/c/sandbox/.m2/repository";
[ ! -z "${MAVEN_HOME}" ] && typeset -x PATH="${PATH}:${M2_HOME}/bin";
[ ! -z "${MAVEN_HOME}" ] && typeset -x LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:${M2_HOME}/lib";
[ ! -z "${MAVEN_HOME}" ] && typeset -x LIBPATH="${LIBPATH}:${M2_HOME}/lib";
[ ! -z "${MAVEN_HOME}" ] && typeset -x LIB_PATH="${LIB_PATH}:${M2_HOME}/lib";

## tomcat
[ -d "/opt/Apache/tomcat/current" ] && typeset -x CATALINA_HOME="/opt/Apache/tomcat/current";
[ -d "/opt/Apache/tomcat/current" ] && typeset -x CATALINA_BASE="/opt/Apache/tomcat/current";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=${JMX_PORT}";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dorg.apache.catalina.tribes.dns_lookups=true -Dorg.apache.jasper.compiler.Generator.STRICT_GET_PROPERTY=true";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dorg.apache.jasper.compiler.Parser.STRICT_QUOTE_ESCAPING=true -Dorg.apache.jasper.compiler.Parser.STRICT_WHITESPACE=true";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false -Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true -Dorg.apache.tomcat.websocket.STRICT_SPEC_COMPLIANCE=true";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dorg.apache.tomcat.util.http.ServerCookie.ALWAYS_ADD_EXPIRES=true -Dorg.apache.tomcat.util.http.ServerCookie.FWD_SLASH_IS_SEPARATOR=true";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dorg.apache.tomcat.util.http.ServerCookie.STRICT_NAMING=true -Dorg.apache.catalina.core.StandardHostValve.ACCESS_SESSION=true";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dorg.apache.catalina.session.StandardSession.ACTIVITY_CHECK=true -Dorg.apache.catalina.session.StandardSession.LAST_ACCESS_AT_START=true";
[ ! -z "${CATALINA_HOME}" ] && typeset -x CATALINA_OPTS="${CATALINA_OPTS} -Dorg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true";

## specific to ${CATALINA_HOME}
[ ! -z "${CATALINA_HOME}" ] && typeset -x PATH="${PATH}:${CATALINA_HOME}/bin";
[ ! -z "${CATALINA_HOME}" ] && typeset -x LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:${CATALINA_HOME}/lib";
[ ! -z "${CATALINA_HOME}" ] && typeset -x LIBPATH="${LIBPATH}:${CATALINA_HOME}/lib";
[ ! -z "${CATALINA_HOME}" ] && typeset -x LIB_PATH="${LIB_PATH}:${CATALINA_HOME}/lib";

## specific to ${CATALINA_BASE} if not the same as ${CATALINA_HOME}
[ ! -z "${CATALINA_BASE}" ] && [ "${CATALINA_BASE}" !=  "${CATALINA_HOME}" ] && typeset -x PATH="${PATH}:${CATALINA_BASE}/bin";
[ ! -z "${CATALINA_BASE}" ] && [ "${CATALINA_BASE}" !=  "${CATALINA_HOME}" ] && typeset -x LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:${CATALINA_BASE}/lib";
[ ! -z "${CATALINA_BASE}" ] && [ "${CATALINA_BASE}" !=  "${CATALINA_HOME}" ] && typeset -x LIBPATH="${LIBPATH}:${CATALINA_BASE}/lib";
[ ! -z "${CATALINA_BASE}" ] && [ "${CATALINA_BASE}" !=  "${CATALINA_HOME}" ] && typeset -x LIB_PATH="${LIB_PATH}:${CATALINA_BASE}/lib";

## geronimo
[ -d "/opt/Apache/geronimo/current" ] && typeset -x GERONIMO_HOME="/opt/Apache/geronimo/current";
[ ! -z "${GERONIMO_HOME}" ] && typeset -x PATH="${PATH}:${GERONIMO_HOME}/bin";
[ ! -z "${GERONIMO_HOME}" ] && typeset -x LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:${GERONIMO_HOME}/lib";
[ ! -z "${GERONIMO_HOME}" ] && typeset -x LIBPATH="${LIBPATH}:${GERONIMO_HOME}/lib";
[ ! -z "${GERONIMO_HOME}" ] && typeset -x LIB_PATH="${LIB_PATH}:${GERONIMO_HOME}/lib";

[ ! -z "${ENABLE_VERBOSE}" ] && [ "${ENABLE_VERBOSE}" = "${_TRUE}" ] && set +x;
[ ! -z "${ENABLE_TRACE}" ] && [ "${ENABLE_TRACE}" = "${_TRUE}" ] && set +v;
